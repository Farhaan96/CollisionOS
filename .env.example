# =====================================================================
# CollisionOS Environment Configuration
# =====================================================================

# -------------------------------------------------------------------
# Application Settings
# -------------------------------------------------------------------
NODE_ENV=development
PORT=3001
APP_NAME=CollisionOS
APP_VERSION=1.0.0

# -------------------------------------------------------------------
# Database Configuration (SQLite - Primary/Local)
# -------------------------------------------------------------------
DATABASE_PATH=./database.sqlite
DATABASE_LOGGING=false

# -------------------------------------------------------------------
# Supabase Configuration (Optional - for hybrid cloud sync)
# -------------------------------------------------------------------
# Enable Supabase integration (set to 'true' to enable hybrid mode)
ENABLE_SUPABASE=false

# Supabase Project Credentials
# Get these from your Supabase project settings: https://app.supabase.com
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# -------------------------------------------------------------------
# Cloud Sync Configuration (Hybrid Mode)
# -------------------------------------------------------------------
# Master toggle for cloud synchronization
SYNC_ENABLED=false

# Feature-specific sync toggles
SYNC_BMS_INGESTION=false          # BMS XML processing via Edge Functions
SYNC_MOBILE=false                 # Mobile app data synchronization
SYNC_MULTI_LOCATION=false         # Multi-location shop support
SYNC_FILE_BACKUP=false            # Automatic file backups to Supabase Storage
SYNC_REALTIME=false               # WebSocket real-time updates

# Sync Performance Settings
SYNC_INTERVAL_MS=30000            # Sync interval in milliseconds (default: 30 seconds)
SYNC_BATCH_SIZE=50                # Number of records per sync batch
SYNC_RETRY_ATTEMPTS=3             # Number of retry attempts for failed syncs
SYNC_RETRY_DELAY_MS=5000          # Delay between retries in milliseconds

# Sync Conflict Resolution
SYNC_CONFLICT_STRATEGY=last-write-wins  # Options: last-write-wins, manual, client-wins, server-wins

# -------------------------------------------------------------------
# Authentication & Security
# -------------------------------------------------------------------
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d
BCRYPT_ROUNDS=10

# Session Settings
SESSION_SECRET=your-session-secret-change-this
SESSION_MAX_AGE=86400000          # 24 hours in milliseconds

# CORS Settings
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# -------------------------------------------------------------------
# Email Configuration (Optional)
# -------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Email From Address
EMAIL_FROM=CollisionOS <noreply@collisionos.com>

# -------------------------------------------------------------------
# SMS/Twilio Configuration (Optional - Phase 3)
# -------------------------------------------------------------------
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# -------------------------------------------------------------------
# Payment Processing (Optional - Phase 2)
# -------------------------------------------------------------------
# Stripe
STRIPE_PUBLIC_KEY=pk_test_your_public_key
STRIPE_SECRET_KEY=sk_test_your_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Square
SQUARE_APPLICATION_ID=your-square-app-id
SQUARE_ACCESS_TOKEN=your-square-access-token
SQUARE_LOCATION_ID=your-square-location-id

# -------------------------------------------------------------------
# QuickBooks Integration (Optional - Phase 2)
# -------------------------------------------------------------------
QUICKBOOKS_CLIENT_ID=your-quickbooks-client-id
QUICKBOOKS_CLIENT_SECRET=your-quickbooks-client-secret
QUICKBOOKS_REDIRECT_URI=http://localhost:3001/api/quickbooks/callback
QUICKBOOKS_ENVIRONMENT=sandbox          # Options: sandbox, production

# -------------------------------------------------------------------
# Parts Vendor API Integration (Optional - Phase 4)
# -------------------------------------------------------------------
# CollisionLink (OEConnection)
COLLISIONLINK_API_KEY=your-collisionlink-api-key
COLLISIONLINK_SHOP_ID=your-shop-id

# Keystone/LKQ
KEYSTONE_API_KEY=your-keystone-api-key
KEYSTONE_ACCOUNT_NUMBER=your-account-number

# PartsTracer
PARTSTRACER_API_KEY=your-partstracer-api-key

# -------------------------------------------------------------------
# VIN Decoder API (Optional)
# -------------------------------------------------------------------
VIN_DECODER_API_KEY=your-vin-decoder-api-key
VIN_DECODER_PROVIDER=nhtsa              # Options: nhtsa, carmd, vindecoder

# -------------------------------------------------------------------
# File Storage & Upload
# -------------------------------------------------------------------
UPLOAD_MAX_SIZE=10485760                # 10MB in bytes
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/webp,application/pdf,application/xml

# Local file storage path (when not using Supabase Storage)
UPLOADS_DIR=./uploads

# Supabase Storage Bucket (when using Supabase)
SUPABASE_STORAGE_BUCKET=collision-os-attachments

# -------------------------------------------------------------------
# Logging & Monitoring
# -------------------------------------------------------------------
LOG_LEVEL=info                          # Options: error, warn, info, debug, trace
LOG_FORMAT=json                         # Options: json, pretty
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/app.log

# Error Tracking (Optional - Sentry)
SENTRY_DSN=your-sentry-dsn

# -------------------------------------------------------------------
# Shop Configuration (Defaults)
# -------------------------------------------------------------------
DEFAULT_TIMEZONE=America/Vancouver
DEFAULT_CURRENCY=CAD
DEFAULT_LABOR_RATE=100.00
DEFAULT_TAX_RATE=5.00                   # GST/HST percentage

# -------------------------------------------------------------------
# Feature Flags
# -------------------------------------------------------------------
FEATURE_BMS_IMPORT=true
FEATURE_MOBILE_APP=false
FEATURE_CUSTOMER_PORTAL=false
FEATURE_ADAS_CALIBRATION=true
FEATURE_DIGITAL_INSPECTION=false
FEATURE_TIME_CLOCK=true

# -------------------------------------------------------------------
# Performance & Optimization
# -------------------------------------------------------------------
CACHE_ENABLED=true
CACHE_TTL=3600                          # Cache TTL in seconds
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000              # 1 minute

# -------------------------------------------------------------------
# Development & Debugging
# -------------------------------------------------------------------
DEBUG=false
ENABLE_SWAGGER_DOCS=true
ENABLE_API_PLAYGROUND=true

# Electron Development
ELECTRON_START_URL=http://localhost:3000

# -------------------------------------------------------------------
# Production Security (Change in Production!)
# -------------------------------------------------------------------
# IMPORTANT: Generate strong random values for production
# Use: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# Uncomment and set for production:
# JWT_SECRET=GENERATE_RANDOM_64_CHAR_HEX_STRING
# SESSION_SECRET=GENERATE_RANDOM_64_CHAR_HEX_STRING
# DATABASE_ENCRYPTION_KEY=GENERATE_RANDOM_32_CHAR_HEX_STRING

# -------------------------------------------------------------------
# Multi-Tenant Configuration (Optional - Future)
# -------------------------------------------------------------------
MULTI_TENANT_ENABLED=false
TENANT_ISOLATION=shop_id                # Database field for tenant isolation

# -------------------------------------------------------------------
# Backup Configuration (Optional)
# -------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *              # Cron: Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=./backups

# -------------------------------------------------------------------
# API Rate Limiting
# -------------------------------------------------------------------
API_RATE_LIMIT_WINDOW_MS=900000        # 15 minutes
API_RATE_LIMIT_MAX_REQUESTS=100

# BMS Import Rate Limiting (prevent abuse)
BMS_IMPORT_RATE_LIMIT_MAX=10           # Max imports per hour
BMS_IMPORT_MAX_SIZE_MB=5               # Max file size

# -------------------------------------------------------------------
# Health Check & Status
# -------------------------------------------------------------------
HEALTH_CHECK_ENABLED=true
STATUS_PAGE_ENABLED=true

# -------------------------------------------------------------------
# Notes for Deployment
# -------------------------------------------------------------------
# 1. NEVER commit this file with real credentials to version control
# 2. Generate strong random secrets for production
# 3. Use environment-specific .env files (.env.production, .env.staging)
# 4. For Docker, use Docker secrets or environment variables
# 5. For cloud deployments, use platform-specific secret managers
#    (AWS Secrets Manager, Google Secret Manager, Azure Key Vault)

# Estimated Monthly Costs (with all features enabled):
# - Supabase Free Tier: $0
# - BMS Ingestion: ~$10/month
# - Mobile Sync: ~$15/month
# - Multi-Location: ~$20/month
# - File Backup: ~$25/month (depends on usage)
# - Real-time Updates: ~$30/month
# Total with all features: ~$100/month (estimate)
